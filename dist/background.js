var e,t,r=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertyNames,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,i)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,__spreadValues=(e,t)=>{for(var r in t||(t={}))s.call(t,r)&&__defNormalProp(e,r,t[r]);if(n)for(var r of n(t))c.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__spreadProps=(e,t)=>i(e,o(t)),__async=(e,t,r)=>new Promise(((i,o)=>{var fulfilled=e=>{try{step(r.next(e))}catch(t){o(t)}},rejected=e=>{try{step(r.throw(e))}catch(t){o(t)}},step=e=>e.done?i(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((r=r.apply(e,t)).next())})),l=(e={"background.js"(e){const t=chrome.runtime.getURL("index.html"),r=400,i=600,o=1500;let a={timeLeft:o,isActive:!1,isPaused:!1,isBreak:!1},n=null,s=[];self.addEventListener("activate",(e=>{e.waitUntil(clients.claim())})),chrome.runtime.onConnect.addListener((e=>{s.push(e),e.onDisconnect.addListener((()=>{s=s.filter((t=>t!==e))}))}));const sendMessageToAllPorts=e=>{s.forEach((t=>{try{t.postMessage(e)}catch(r){console.error("Error sending message to port:",r)}}))};chrome.action.onClicked.addListener((()=>__async(e,null,(function*(){try{(yield(a=t,__async(e,null,(function*(){return(yield chrome.windows.getAll({populate:!0})).some((e=>{var t;return null==(t=e.tabs)?void 0:t.some((e=>e.url===a))}))}))))||(yield(o={url:t,width:r,height:i},__async(e,null,(function*(){const{url:e,width:t=r,height:a=i,type:n="popup"}=o;return chrome.windows.create({url:e,width:t,height:a,type:n,focused:!0})}))))}catch(n){console.error("Error handling action click:",n)}var o,a})))),chrome.runtime.onMessage.addListener(((e,t,r)=>{switch(e.type){case"START_TIMER":n&&clearInterval(n),a=__spreadProps(__spreadValues({},a),{isActive:!0,isPaused:!1}),n=window.setInterval((()=>{a.timeLeft>0&&!a.isPaused&&(a=__spreadProps(__spreadValues({},a),{timeLeft:a.timeLeft-1}),sendMessageToAllPorts({type:"TIMER_UPDATE",state:a}),0===a.timeLeft)&&(n&&clearInterval(n),new Audio(chrome.runtime.getURL("notification.wav")).play().catch(console.error),chrome.notifications.create({type:"basic",iconUrl:"icons/icon48.png",title:a.isBreak?"Break Complete!":"Focus Session Complete!",message:a.isBreak?"Ready to focus?":"Time for a break!"}),a=__spreadProps(__spreadValues({},a),{isActive:!1,isBreak:!a.isBreak,timeLeft:a.isBreak?o:300}),sendMessageToAllPorts({type:"TIMER_COMPLETE",state:a}))}),1e3);break;case"PAUSE_TIMER":a=__spreadProps(__spreadValues({},a),{isPaused:!0}),sendMessageToAllPorts({type:"TIMER_PAUSE",state:a});break;case"RESUME_TIMER":a.isPaused=!1;break;case"STOP_TIMER":n&&(clearInterval(n),n=null),a={timeLeft:o,isActive:!1,isPaused:!1,isBreak:!1},sendMessageToAllPorts({type:"TIMER_STOP",state:a});break;case"GET_TIMER_STATE":r(a)}return!0}))}},function(){return t||(0,e[a(e)[0]])((t={exports:{}}).exports,t),t.exports});export default l();
//# sourceMappingURL=background.js.map
