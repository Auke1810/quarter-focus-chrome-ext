var e,t,r=Object.defineProperty,n=Object.defineProperties,s=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,o=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var r in t||(t={}))a.call(t,r)&&__defNormalProp(e,r,t[r]);if(o)for(var r of o(t))i.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__spreadProps=(e,t)=>n(e,s(t)),__async=(e,t,r)=>new Promise(((n,s)=>{var fulfilled=e=>{try{step(r.next(e))}catch(t){s(t)}},rejected=e=>{try{step(r.throw(e))}catch(t){s(t)}},step=e=>e.done?n(e.value):Promise.resolve(e.value).then(fulfilled,rejected);step((r=r.apply(e,t)).next())})),l=(e={"background.js"(e){const t=chrome.runtime.getURL("index.html"),r=400,n=600,s=1500;let c={timeLeft:s,isRunning:!1,isPaused:!1,currentPhase:"focus"},o=null;const a=[];self.addEventListener("activate",(e=>{e.waitUntil(self.clients.claim())})),chrome.runtime.onConnect.addListener((e=>{a.push(e),e.onDisconnect.addListener((()=>{const t=a.indexOf(e);t>-1&&a.splice(t,1)}))}));const sendMessageToAllPorts=e=>{a.forEach((t=>{try{t.postMessage(e)}catch(r){console.error("Error sending message to port:",r)}}))};chrome.runtime.onMessage.addListener(((e,t,r)=>{switch(e.type){case"START_TIMER":case"RESUME_TIMER":o&&clearInterval(o),c=__spreadProps(__spreadValues({},c),{isRunning:!0,isPaused:!1}),o=setInterval((()=>{c.timeLeft>0?c=__spreadProps(__spreadValues({},c),{timeLeft:c.timeLeft-1}):(o&&(clearInterval(o),o=null),chrome.notifications.create({type:"basic",iconUrl:"icons/icon48.png",title:"focus"===c.currentPhase?"Focus Session Complete!":"Break Complete!",message:"focus"===c.currentPhase?"Time for a break!":"Ready to focus?"}),c=__spreadProps(__spreadValues({},c),{isRunning:!1,currentPhase:"focus"===c.currentPhase?"break":"focus",timeLeft:"focus"===c.currentPhase?300:s})),sendMessageToAllPorts({type:"TIMER_UPDATE",state:c})}),1e3),sendMessageToAllPorts({type:"TIMER_UPDATE",state:c}),r({success:!0});break;case"PAUSE_TIMER":o&&(clearInterval(o),o=null),c=__spreadProps(__spreadValues({},c),{isRunning:!1,isPaused:!0}),sendMessageToAllPorts({type:"TIMER_UPDATE",state:c}),r({success:!0});break;case"STOP_TIMER":o&&(clearInterval(o),o=null),c={timeLeft:s,isRunning:!1,isPaused:!1,currentPhase:"focus"},sendMessageToAllPorts({type:"TIMER_UPDATE",state:c}),r({success:!0});break;case"GET_TIMER_STATE":r(c);break;default:r({success:!1,error:"Unknown message type"})}return!0})),chrome.action.onClicked.addListener((()=>__async(e,null,(function*(){try{(yield(c=t,__async(e,null,(function*(){return(yield chrome.windows.getAll({populate:!0})).some((e=>{var t;return null==(t=e.tabs)?void 0:t.some((e=>e.url===c))}))}))))||(yield(s={url:t},__async(e,null,(function*(){const{url:e,width:t=r,height:c=n}=s;return chrome.windows.create({url:e,width:t,height:c,type:"popup",focused:!0})}))))}catch(o){console.error("Error handling icon click:",o)}var s,c}))))}},function(){return t||(0,e[c(e)[0]])((t={exports:{}}).exports,t),t.exports});export default l();
//# sourceMappingURL=background.js.map
